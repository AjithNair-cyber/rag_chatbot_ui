// main.scss

// -----------------------------------------------------------
// Redefined Gemini-style variables
// -----------------------------------------------------------
$gemini-bg: #0c0d10; // Dark, near-black background
$gemini-card-bg: #111318; // Slightly lighter for chat window
$gemini-header-bg: #0c0d10;

$gemini-border-color: #24252b;
$gemini-text-primary: #e0e0e0;
$gemini-text-secondary: #999;
$gemini-text-placeholder: #555;

$gemini-accent-blue: #4285f4; // Gemini's signature blue
$gemini-accent-blue-hover: #357ae8;

$gemini-user-message-bg: #302d4f; // Muted dark purple
$gemini-user-message-color: #e3e8ff;

$gemini-bot-message-bg: #1c1d22; // A charcoal color
$gemini-error-message-bg: #4a1a1a; // Dark red for errors
$gemini-bot-message-color: #d1d1d1;

$gemini-reset-color: #a04040;
$gemini-reset-hover: #7b2e2e;

$gemini-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
  "Helvetica Neue", Arial, sans-serif;
$gemini-border-radius: 16px;
$gemini-input-border-radius: 28px;

// -----------------------------------------------------------
// General layout and container styles
// -----------------------------------------------------------

* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  padding: 0;
  height: 100%; // Ensures the html and body elements fill the viewport
}
.chat-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  border-radius: $gemini-border-radius;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
  background: $gemini-bg;
  font-family: $gemini-font-family;
  color: $gemini-text-primary;
}

.chat-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem 1.5rem;
  border-bottom: 1px solid $gemini-border-color;
  background-color: $gemini-header-bg;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
  font-weight: 600;
  font-size: 1rem;
}

.reset-button {
  background: $gemini-reset-color;
  color: white;
  border: none;
  padding: 0.7rem 1.25rem;
  border-radius: $gemini-input-border-radius;
  cursor: pointer;
  font-weight: 600;
  width: 150px;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
  transition: background 0.3s ease, box-shadow 0.3s ease;

  &:hover,
  &:focus {
    background: $gemini-reset-hover;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.6);
    outline: none;
  }
}

// -----------------------------------------------------------
// Chat messages and window
// -----------------------------------------------------------
.chat-window {
  flex: 1 1 auto;
  overflow-y: auto;
  padding: 1.5rem 2rem;
  background-color: $gemini-card-bg;
  scroll-behavior: smooth;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.chat-message {
  max-width: 65%; // Slightly wider messages
  padding: 0.3rem 1rem;
  border-radius: 20px; // More rounded corners
  line-height: 1.5;
  word-wrap: break-word;
  position: relative;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);

  &.user-message {
    background-color: $gemini-user-message-bg;
    color: $gemini-user-message-color;
    margin-left: auto;
    border-bottom-right-radius: 8px;
  }

  &.bot-message {
    background-color: $gemini-bot-message-bg;
    color: $gemini-bot-message-color;
    margin-right: auto;
    border-bottom-left-radius: 8px;
  }

  &.bot-error-message {
    background-color: $gemini-error-message-bg;
    color: $gemini-bot-message-color;
    margin-right: auto;
    border-bottom-left-radius: 8px;
  }

  .typing-cursor {
    display: inline-block;
    animation: blink 1.2s steps(2, start) infinite;
    font-weight: 700;
    color: $gemini-accent-blue;
    position: static;
    margin-left: 4px;
  }
}

// Keyframes for the blinking cursor effect
@keyframes blink {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
}

// -----------------------------------------------------------
// Input area and buttons
// -----------------------------------------------------------
.input-area {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  padding: 1rem 2rem;
  border-top: 1px solid $gemini-border-color;
  background-color: $gemini-bg;
  box-shadow: inset 0 1px 4px rgba(255, 255, 255, 0.05);

  input {
    flex-grow: 1;
    padding: 0.75rem 1.25rem;
    font-size: 1.05rem;
    border-radius: $gemini-input-border-radius;
    border: 1px solid $gemini-border-color;
    background: #111318;
    color: $gemini-text-primary;
    transition: all 0.3s ease;
    outline: none;
    box-shadow: none;
    font-weight: 400;

    &::placeholder {
      color: $gemini-text-placeholder;
    }

    &:focus {
      border-color: $gemini-accent-blue;
      box-shadow: 0 0 12px rgba(66, 133, 244, 0.6);
      background: #15171d;
    }
  }

  button {
    margin-left: 1rem;
    padding: 0.7rem 1.75rem;
    font-size: 1.1rem;
    border: none;
    border-radius: $gemini-input-border-radius;
    background-color: $gemini-accent-blue;
    color: white;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(66, 133, 244, 0.5);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;

    &:hover:not(:disabled),
    &:focus:not(:disabled) {
      background-color: $gemini-accent-blue-hover;
      box-shadow: 0 6px 16px rgba(53, 122, 232, 0.7);
      outline: none;
    }

    &:disabled {
      background-color: $gemini-border-color;
      cursor: not-allowed;
      box-shadow: none;
      color: #777;
    }
  }
}

.sources-list {
  list-style: none;
  padding: 0px 0px 20px 0px;
  margin: 10px 0 0 0;
  display: flex; // Use flexbox for the layout
  flex-wrap: wrap; // Allow items to wrap to the next line
  gap: 8px; // Slightly reduce gap for tighter packing

  li {
    background-color: #f1f1f1;
    border-radius: 20px;
    padding: 6px 12px;
    font-size: 0.8em;
    font-family: Arial, sans-serif;
    transition: background-color 0.2s ease-in-out, flex-basis 0.3s ease-out; // Add transition for flex-basis
    flex: 1; // All items initially take up equal available space
    min-width: 80px; // Minimum width for each item (adjust as needed)
    max-width: 250px; // Maximum width for each item when not hovered
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;

    &:hover {
      transition: all 0.3s ease-in-out;
      background-color: #e0e0e0;
      flex: 2; // On hover, this item grows larger (e.g., 3 times more than others)
      max-width: none; // Allow it to grow beyond the initial max-width if needed
      // If you want to reveal the full URL on hover, you might need to adjust:
      // overflow: visible; // Be careful, this can break layout if content is too long
    }

    a {
      text-decoration: none;
      color: #333;
      display: block; // Ensures the whole list item is clickable
      &:hover {
        color: #007bff;
      }
    }
  }

  // When a list item is hovered, the non-hovered items should "shrink"
  // This is implicit because the hovered item's flex-grow is higher.
  // We can add more explicit control if desired, but flex: 1 and flex: 3
  // usually handle this well on their own within the same flex container.
}

// For dark mode or different themes
@media (prefers-color-scheme: dark) {
  .sources-list {
    li {
      background-color: #333;
      &:hover {
        background-color: #444;
      }
      a {
        color: #ddd;
        &:hover {
          color: #8ab4f8; // Lighter blue for dark mode
        }
      }
    }
  }
}

.typing-indicator {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 6px;
  height: 20px;

  span {
    height: 8px;
    width: 8px;
    border-radius: 50%;
    background-color: #555; // Or a color that fits your theme
    animation: bounce 1.2s infinite ease-in-out;
    transform-origin: bottom;

    &:nth-child(2) {
      animation-delay: 0.2s;
    }

    &:nth-child(3) {
      animation-delay: 0.4s;
    }
  }
}

@keyframes bounce {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-8px);
  }
}
